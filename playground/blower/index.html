<!DOCTYPE html>
<html>
<head>
    <title>Blower</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Lato|Roboto" rel="stylesheet">

    <style type="text/css">
        html {
            font-family: Lato;
            text-align: center;
        }

        * {margin: 0;}
        *, *:after, *:before {box-sizing: border-box;}

        html {
            background-image: linear-gradient(to right, #b8cbb8 0%, #b8cbb8 0%, #b465da 0%, #cf6cc9 33%, #ee609c 66%, #ee609c 100%);
            background-size: 100% 100%;
            background-repeat: no-repeat;
        }

        html, body {
            width: 100%;
            height: 100%;
            width: 100vw;
            height: 100vh;
        }

        button, input[type=radio] + label {
            padding: 0.4em 1rem;
            outline: none;
            color: #424242;
            border: none;
            border-radius: 4px;
            cursor: hand;
            cursor: pointer;
            background-color: rgb(192, 192, 192);
        }

        input[type=radio]:checked + label {
            background-color: #673AB7;
            color: white;
        }

        button[disabled] {
            color: rgb(142, 142, 142);
        }

        label {
            font-family: Roboto;
            font-size: 0.8rem;
        }

        input[type=radio] {
            width: 1px;
            height: 1px;
            opacity: 0;
        }

        #error {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            display: block;
            color: #DD2C00;
        }


        .growarea {
            width: 90%;
            height: 100%;
            max-width: 700px;
            margin: 0 auto;
            font-size: 0;
        }

        .growarea:before {
            content: '';
            display: inline-block;
            height: 100%;
            vertical-align: middle;
        }

        #baloon {
            display: inline-block;
            vertical-align: middle;
            width: 100%;
            padding-bottom: 100%;

            border-radius: 50%;

            background-image: linear-gradient(to top, #48c6ef 0%, #6f86d6 100%);
            background-size: 100% 100%;
            background-repeat: no-repeat;
        }

    </style>
</head>
<body>

    <div class="growarea">
        <div id="baloon"></div>
    </div>

    <p id="error"></p>


    <!-- <button id="button-play">Start capturing</button> <input type="checkbox" name="with-video" id="with-video"><label for="with-video">Capture video</label> -->

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenLite.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/easing/EasePack.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/CSSPlugin.min.js"></script>

    <script type="text/javascript">

        var Application = function () {

            // this.buttonPlay =  document.getElementById('button-play')
            //
            this.baloon = document.getElementById('baloon')
            this.error = document.getElementById('error')

            this.constraints = {
                audio : true
            }

            this.audioSource = null
            this.audioContext = new (window.webkitAudioContext || window.AudioContext)()
            this.audioGain = this.audioContext.createGain();

            this.startCapture = this.startCapture.bind(this);
            this.handleUserMediaError = this.handleUserMediaError.bind(this);
            this.handleUserMediaStream = this.handleUserMediaStream.bind(this);

            // this.buttonPlay.addEventListener('click', this.startCapture);
            //
            this.animateIn();

        }

        Application.prototype = {


            animateIn: function () {
                console.log('Animin');
                new TweenLite.to(this.baloon, 0.8, {scaleX: 0.2, scaleY: 0.6, force3D: true, ease: Elastic.easeOut.config(1, 0.4)})
            },

            handleUserMediaError: function(e) {
                this.error.innerText = e.toString() + '\n --- ' + JSON.stringify(e)
            },

            handleUserMediaStream: function(stream) {
                this.error.innerText = ""
                this.audioSource = this.audioContext.createMediaStreamSource(stream)
            },

            startCapture: function() {
                var getUserMedia
                if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                    getUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices)
                } else {
                    getUserMedia = window.getUserMedia
                }

                getUserMedia({audio: true}).then(this.handleUserMediaStream)
                  .catch(this.handleUserMediaError)
            }
        }

        window.onload = function() {
            window.application = new Application();
            window.application.startCapture();
            if (window.eruda) eruda.init();
        }


    </script>
    <script>
        if (/eruda=true/.test(window.location) && localStorage.getItem('active-eruda') != 'true') {
            document.write('<scr' + 'ipt src="//cdn.jsdelivr.net/eruda/1.2.2/eruda.min.js"></scr' + 'ipt>');
            document.write('<scr' + 'ipt>eruda.init();</scr' + 'ipt>');
        }
    </script>

</body>

</html>
